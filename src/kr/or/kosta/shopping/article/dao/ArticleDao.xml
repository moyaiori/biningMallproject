<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
                        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 네임스페이스(사용영역) 설정 -->
<mapper namespace="kr.or.kosta.shopping.article.dao.ArticleDao">

		
	<!-- 게시글 등록 boardId: 1 - 공지 , 2 QnA-->
	<insert id="insert" parameterType="kr.or.kosta.shopping.article.domain.Article">
		INSERT INTO article(article_id, board_id, member_id, subject, content,group_num,step_num, order_num)
		VALUES(article_id_seq.NEXTVAL,  #{boardId},  #{memberId}, #{subject}, #{content},article_id_seq.CURRVAL,0, 0)
	</insert>
     
     <select id="getAllCnt"   resultType="java.lang.Integer">
		 select COUNT(article_id) count 
		from article
		where board_id=1
	</select>
     
     
                 
 <!--   게시글 읽기      -->	           
	<select id="get" parameterType="java.lang.Integer" resultType="kr.or.kosta.shopping.article.domain.Article">
		SELECT article_id as "articleId", subject, content, member_id as "memberId", regdate, hitcount, group_num as "groupNum", step_num as "stepNum", order_num as "orderNum"
	    FROM article 
		WHERE board_id = 1 and article_id = #{value}
	</select>

	<select id="getAll" parameterType="java.lang.Integer"   resultType="kr.or.kosta.shopping.article.domain.Article">
		 SELECT  article_id as "articleId", subject, member_id as "memberId", regdate, hitcount, step_num as "stepNum"
 		 FROM (
					     SELECT CEIL(rownum / 10) request_page, article_id, subject, member_id, TO_CHAR(regdate, 'YYYY-MM-DD') regdate,  hitcount, step_num
					     FROM ( 
					         SELECT article_id, subject, member_id, regdate, hitcount, step_num
                             FROM article 
					         WHERE board_id =  1
					         ORDER BY group_num DESC, order_num ASC 
					         )
					)WHERE request_page = #{value}
	</select>
	
	
	<!-- 글 상세 보기 시, 조회수 증가.-->
	<update id="updateHitcount" parameterType="java.lang.Integer" >
			UPDATE article 
					SET hitcount = hitcount + 1 
					WHERE board_id =1 AND article_id =#{articleId}
	</update>
	
	<!--  제목 혹은 내용으로 검색  -->
	<select id="selectEmployeesByLastName"  parameterType="java.lang.String" resultType="kr.or.kosta.shopping.article.domain.Article">

		SELECT employee_id "id", first_name "firstName", last_name "lastName", email "email", phone_number "phoneNumber", TO_CHAR(hire_date, 'YYYY-MM-DD') "hireDate", salary "salary"
		FROM employees
		WHERE UPPER(last_name) like #{lastName}
	</select>
	
	
	
	
	
</mapper>